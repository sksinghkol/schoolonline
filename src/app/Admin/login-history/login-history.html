<div class="login-history container py-5">
    <h2 class="mb-5 text-center text-gradient">Admin Login History</h2>
  
    <ng-container *ngIf="loginRecords$ | async as records; else loading">
      <ng-container *ngIf="records.length > 0; else empty">
        <div class="row g-4">
          <div class="col-12 col-sm-6 col-md-6 col-lg-3" *ngFor="let r of records; trackBy: trackById">
            <div class="login-card p-3">
              <!-- Avatar and Name -->
              <div class="d-flex align-items-center mb-3">
                <img 
                  [src]="r.photoURL || currentPhotoURL || 'https://www.gravatar.com/avatar/?d=mp'" 
                  alt="avatar" class="rounded-circle avatar me-3"
                  (error)="onImgError($event)"
                >
                <div>
                  <div class="fw-bold fs-6">{{ r.displayName || r.email || 'Unknown User' }}</div>
                  <small class="text-muted">
                    {{ r.loginAt?.toDate ? (r.loginAt.toDate() | date:'EEEE, d MMMM y, h:mm a') : (r.loginAt | date:'EEEE, d MMMM y, h:mm a') }}
                  </small>
                </div>
              </div>
  
              <!-- IP -->
              <div class="text-muted mb-2"><strong>IP:</strong> {{ r.ipAddress || 'Unknown' }}</div>
  
              <!-- Location Badges -->
              <div class="mb-2">
                <strong>Location:</strong>
                <span class="badge bg-gradient-info me-1">{{ r.geoInfo?.city || '—' }}</span>
                <span class="badge bg-gradient-info me-1">{{ r.geoInfo?.region || '—' }}</span>
                <span class="badge bg-gradient-info me-1">{{ r.geoInfo?.country || '—' }}</span>
              </div>
  
              <!-- Device Badges -->
              <div>
                <strong>Device:</strong>
                <span class="badge bg-gradient-secondary me-1">{{ r.deviceInfo?.browser || 'Browser' }}</span>
                <span class="badge bg-gradient-secondary me-1">{{ r.deviceInfo?.os || 'OS' }}</span>
                <span class="badge bg-gradient-secondary">{{ r.deviceInfo?.type || 'Device' }}</span>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
  
    <!-- Loading -->
    <ng-template #loading>
      <div class="text-center text-muted py-3">
        <i class="bi bi-hourglass-split me-2"></i>Loading login records…
      </div>
    </ng-template>
  
    <!-- Empty -->
    <ng-template #empty>
      <div class="text-center text-muted py-3">
        <i class="bi bi-exclamation-circle me-2"></i>No login records found.
      </div>
    </ng-template>
  </div>
  